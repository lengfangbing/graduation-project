"use strict";var fs=require("fs"),path=require("path");module.exports=function(e,i,t){e.get("/admin/checkList",function(t){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(i.findInTable("invitation",{status:0}));case 2:(n=e.sent).status?t.body={code:1,data:n.body}:t.body={code:0,message:"发帖失败, 标题重复"};case 4:case"end":return e.stop()}})}),e.post("/admin/accept",function(t){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.request.body.invitationId,e.next=3,regeneratorRuntime.awrap(i.updateOne("invitation",{invitationId:n},{status:1}));case 3:e.sent.status?t.body={code:1,message:"审核通过~"}:t.body={code:0,message:"网络错误"};case 5:case"end":return e.stop()}})}),e.post("/admin/reject",function(t){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.request.body.invitationId,e.next=3,regeneratorRuntime.awrap(i.updateOne("invitation",{invitationId:n},{status:2}));case 3:e.sent.status?t.body={code:1,message:"审核驳回!"}:t.body={code:0,message:"网络错误"};case 5:case"end":return e.stop()}})}),e.post("/autoCheck",function(t){var n,a,s,r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.request.body,a=n.invitationId,s=n.status,r=n.authorId,e.next=3,regeneratorRuntime.awrap(i.updateOne("invitation",{invitationId:+a},{status:+s}));case 3:e.sent.status&&(globalThis.socket.emit("auto",{status:s,invitationId:a,authorId:r}),globalThis.socket.emit("refresh"),globalThis.socket.broadcast.emit("refresh"));case 5:case"end":return e.stop()}})})};